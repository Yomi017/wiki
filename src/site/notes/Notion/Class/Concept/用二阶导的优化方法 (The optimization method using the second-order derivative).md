---
{"dg-publish":true,"permalink":"/notion/class/concept/the-optimization-method-using-the-second-order-derivative/"}
---

我们通过**一次**反向传播，计算出所有参数**应该改变的“初始方向”**（即梯度 `g`）。然后，我们**不是**立即按照这个方向去改变参数，而是把这个“初始方向”交给二阶导（海森矩阵 `H`）进行**“审阅和修正”**，得出一个**最终的、更智能的“实际改变方案” `Δθ`**，最后再用这个最终方案去**执行一次**参数的改变。

让我们用一个更生动的比喻来描述这个流程。

---

### 公司年度战略规划会议

*   **公司**: 神经网络。
*   **CEO**: 损失函数 `L`。
*   **各部门（研发、市场、销售...）**: 网络的各层参数 `θ`（卷积核，权重等）。
*   **年度目标**: 最小化成本 `L`。

#### **方案一：一阶方法 (梯度下降)**

1.  **CEO发出模糊指令**: CEO说：“今年亏损了，我们要削减成本！”
2.  **各部门提交初步计划 (计算梯度 `g`)**:
    *   研发部经理（一个卷积核参数）通过**反向传播**分析，发现自己的部门对亏损有一定责任，于是提交了一个计划：“我建议我们部门裁员5%。” (这就是 `∂L/∂θ_研发`)
    *   市场部经理（另一个权重参数）也提交计划：“我建议我们部门削减广告预算10%。” (这就是 `∂L/∂θ_市场`)
    *   ...所有部门都提交了只考虑自己的初步计划。
3.  **CEO的最终决策 (执行更新)**:
    *   CEO 觉得每个部门的计划都有道理，但又怕大家步子迈太大扯到蛋。于是他大手一挥：“行，就按你们说的方向改，但为了稳妥，所有部门的削减幅度都统一打个折，只执行计划的1%（学习率 `η`）。”
    *   **最终改变**: `θ_new = θ_old - η * g`。

**特点**: 简单粗暴，每个部门只考虑自己，CEO只做统一缩放，没有考虑各部门之间的联动效应。

#### **方案二：二阶方法 (牛顿法)**

1.  **CEO发出模糊指令**: 同上，“我们要削减成本！”
2.  **各部门提交初步计划 (计算梯度 `g`)**: 同上，每个部门都提交了只考虑自己的初步计划 `g`。

3.  **引入战略顾问委员会 (计算海森矩阵 `H` 和 `H⁻¹`)**:
    *   在CEO做最终决策前，他把所有部门的初步计划 `g` 交给了公司的**战略顾问委员会**。
    *   这个委员会的成员是经济学家、行业专家（海森矩阵 `H`）。他们**不**直接告诉每个部门该干嘛，而是分析**整个公司的“经济模型”**。
    *   他们分析发现：
        *   “虽然研发部裁员5%看起来能省钱（梯度 `g_研发` 为负），但我们的分析（海森矩阵的交叉项 `H_研发,市场`）表明，裁掉研发人员会导致明年新产品延期，市场部的广告会完全打水漂，造成更大的亏损！”
        *   “市场部的广告预算虽然可以砍（梯度 `g_市场` 为负），但我们的分析（海森矩阵的对角项 `H_市场,市场`）表明，市场部这个方向非常‘陡峭’，砍10%太多了，会立刻丢失市场份额，砍1%就够了。”
        *   “销售部的提成制度（参数 `θ_销售`）虽然梯度不大，但我们的分析（`H_销售,销售`）表明这个方向非常‘平坦’，改革一下能带来巨大收益，应该大胆地改！”

4.  **顾问委员会提交最终行动方案 (计算 `Δθ = -H⁻¹g`)**:
	* [[Notion/Class/Concept/H 和 H⁻¹ 的几何意义\|H 和 H⁻¹ 的几何意义]]
    *   委员会综合了所有部门的初步计划 `g` 和他们对整个公司经济模型的分析 `H`，出具了一份**全局最优的、修正后**的行动方案 `Δθ`。
    *   这份方案可能建议：“研发部不但不能裁员，还要**增加**2%的预算！市场部只砍1%预算，销售部把提成制度**彻底改革**！”

5.  **CEO的最终决策 (执行更新)**:
    *   CEO完全采纳了战略顾问委员会的最终方案。
    *   **最终改变**: `θ_new = θ_old + Δθ`。

---

1.  我们**计算**出了一套所有参数的**“初步改变意向”**（梯度 `g`）。
2.  我们**使用**二阶导（海森矩阵 `H`）来**修正**这套“初步意向”，得到一套**“最终改变方案”**（牛顿步长 `Δθ`）。
3.  我们用这套最终方案，对所有参数**执行一次改变**。

整个过程只有**一次**参数的物理更新。二阶导的作用是在这次更新**发生之前**，提供一个更智能、更全局的视角，来**指导**这次更新该如何进行。