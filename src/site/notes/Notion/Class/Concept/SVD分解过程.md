---
{"dg-publish":true,"permalink":"/notion/class/concept/svd/"}
---

# **奇异值分解 (SVD) 计算流程笔记**

### **核心定义**

任何一个 `m x n` 的矩阵 `A` 都可以被分解为三个矩阵的乘积：
$$
A = U \Sigma V^T
$$

-   **`U`**: 一个 `m x m` 的**正交矩阵** (Orthogonal Matrix)。其列向量 `uᵢ` 被称为**左奇异向量 (Left Singular Vectors)**。
-   **`Σ` (Sigma)**: 一个 `m x n` 的**对角矩阵**。其对角线上的元素 `σᵢ` 被称为**奇异值 (Singular Values)**。它们非负 (`σᵢ ≥ 0`) 且按从大到小的顺序排列。
-   **`V`**: 一个 `n x n` 的**正交矩阵**。其列向量 `vᵢ` 被称为**右奇异向量 (Right Singular Vectors)**。`V^T` 是 `V` 的转置。

### **计算流程：三步走战略**

我们的目标是依次求出 `V`、`Σ` 和 `U`。

---

### Step 1: 计算 V 和 Σ (从 $A^T A$ 入手)

这一步的目标是找到输入空间的“特殊正交基” `V` 以及相应的“拉伸系数” `Σ`。

1.  构造对称矩阵 $A^T A$
    *   计算矩阵 `A` 的转置 `A^T`。
    *   计算乘积 `M = A^T A`。这个结果必然是一个 `n x n` 的**对称矩阵**。
[[Notion/Class/Method/特征值计算技巧\|特征值计算技巧]]
2.  对 $A^T A$ 进行特征分解
    *   **求特征值**: 解特征方程 `det(A^T A - λI) = 0`，得到 `A^T A` 的 `n` 个特征值 `λ₁, λ₂, ..., λₙ`。
        *   *重要性质：这些特征值必然是非负的 (`λᵢ ≥ 0`)*。
    *   **求特征向量**: 对于每一个特征值 `λᵢ`，解齐次方程组 `(A^T A - λᵢI)x = 0`，得到对应的特征向量。

3.  构建 `Σ` 和 `V`
    *   **构建 `Σ` (奇异值矩阵)**:
        1.  计算奇异值：$σᵢ = \sqrt{λᵢ}$。
        2.  将奇异值**从大到小排序**：`σ₁ ≥ σ₂ ≥ ... ≥ σᵣ > 0` (其中 `r` 是矩阵 `A` 的秩)。
        3.  将排序后的奇异值填入 `m x n` 矩阵 `Σ` 的对角线位置。其余位置全部填0。
           $$
           \Sigma = \begin{bmatrix}
           \sigma_1 & 0 & \cdots & 0 \\
           0 & \sigma_2 & \cdots & 0 \\
           \vdots & \vdots & \ddots & \vdots \\
           0 & 0 & \cdots & \sigma_n \\
           \vdots & \vdots & & \vdots \\
           0 & 0 & \cdots & 0
           \end{bmatrix}_{m \times n}
           $$

    *   **构建 `V` (右奇异向量矩阵)**:
        1.  将 `A^T A` 的特征向量按照**对应于 `σᵢ` 排序后**的顺序排列。
        2.  对这些特征向量进行**单位化 (Normalize)**，得到一组标准正交基 `{v₁, v₂, ..., vₙ}`。
        3.  将这些单位化的特征向量作为列向量，构建 `n x n` 的正交矩阵 `V`。
           $$
           V = \begin{bmatrix} | & | & & | \\ v_1 & v_2 & \cdots & v_n \\ | & | & & | \end{bmatrix}
           $$

---

### Step 2: 计算 U (左奇异向量矩阵)

这一步的目标是找到输出空间的“特殊正交基” `U`。

1.  **计算与非零奇异值对应的 `uᵢ`**
    *   对于每一个**非零**的奇异值 `σᵢ` (i 从 1 到 r)，使用以下关系式计算对应的左奇异向量 `uᵢ`：
        $$
        u_i = \frac{1}{\sigma_i} A v_i
        $$
        *这里的 `vᵢ` 是你在 Step 1 中计算出的、与 `σᵢ` 对应的右奇异向量。*

2.  **处理可能存在的“补充”向量 (如果 m > r)**
    *   你已经通过上面的方法得到了 `r` 个左奇异向量 `{u₁, u₂, ..., uᵣ}`。
    *   **IF `m = r`**: 恭喜，你已经找到了所有的 `u` 向量。
    *   **IF `m > r`**: 你还需要找到 `m - r` 个额外的向量 `{u_{r+1}, ..., u_m}` 来填满 `U` 矩阵。这些向量构成了 `A^T` 的零空间 (Null Space) 的一组标准正交基。
        1.  解方程组 `A^T y = 0`。
        2.  求出其解空间的一组基。
        3.  使用**格拉姆-施密特正交化 (Gram-Schmidt Process)** 方法将这组基以及之前算出的 `{u₁, ..., uᵣ}` 合并，得到一个完整的标准正交基 `{u₁, ..., u_m}`。

3.  **构建 `U`**
    *   将所有 `m` 个单位化的、互相正交的左奇异向量 `{u₁, u₂, ..., u_m}` 作为列向量，构建 `m x m` 的正交矩阵 `U`。
       $$
       U = \begin{bmatrix} | & | & & | \\ u_1 & u_2 & \cdots & u_m \\ | & | & & | \end{bmatrix}
       $$

---

### Step 3: 最终检验

*   将你计算出的 `U`, `Σ`, `V^T` 相乘。
*   验证 `U Σ V^T` 是否等于原始矩阵 `A`。
*   同时检查 `U` 和 `V` 是否真的是正交矩阵 (`U^T U = I`, `V^T V = I`)。
