---
{"dg-publish":true,"permalink":"/wiki/notion/class/artificial-intelligence/mathematics-for-ai/concept/h-h/"}
---

想象一下，在损失函数的某个点（比如一个山谷的谷底附近），我们画出所有让损失值增加一个微小量（比如增加1）的点，这些点会构成一个**椭球 (ellipsoid)**。

#### 1. 海森矩阵 `H`：描述“等高线椭球”的形状

*   **`H` 的特征向量**: 指出了这个**椭球的主轴方向**。这些是曲面“最纯粹”的弯曲方向，在这些方向上没有扭曲。
*   **`H` 的特征值 (λ)**: 描述了在主轴方向上的**曲率（弯曲程度）**。
    *   **大的特征值 `λ_large`**: 对应椭球的**短轴**。这意味着在这个方向上，损失函数**非常陡峭**，你只需要稍微移动一点点，损失值就会增加1。
    *   **小的特征值 `λ_small`**: 对应椭球的**长轴**。这意味着在这个方向上，损失函数**非常平缓**，你需要移动很长一段距离，损失值才会增加1。

**总结 `H`**:
**海森矩阵 `H` 描述了损失函数等高线的形状。它的特征向量是椭球的轴向，特征值与轴长的平方成反比。**

#### 2. 逆海森矩阵 `H⁻¹`：描述“单位步长椭球”的形状

现在，我们来看 `H⁻¹`。因为 `H` 和 `H⁻¹` 互为逆矩阵，它们共享相同的特征向量，但特征值互为倒数。

*   **`H⁻¹` 的特征向量**: 与 `H` 相同，同样是椭球的**主轴方向**。
*   **`H⁻¹` 的特征值 (1/λ)**:
    *   对应 `H` 的大特征值 `λ_large` 的方向（短轴），`H⁻¹` 的特征值是 `1/λ_large`，一个**很小**的值。
    *   对应 `H` 的小特征值 `λ_small` 的方向（长轴），`H⁻¹` 的特征值是 `1/λ_small`，一个**很大**的值。

`H⁻¹` 描述了一个“逆椭球”，这个逆椭球的几何意义是：**它将一个在所有方向上都“走一步”的圆形区域，拉伸成一个适应地形的椭球区域。**
*   在地形**陡峭**的方向，它把步子**压缩得很短**。
*   在地形**平缓**的方向，它把步子**拉得很长**。

**总结 `H⁻¹`**:
**逆海森矩阵 `H⁻¹` 是一个“地形适应性”的拉伸变换。它在曲率大的方向上进行压缩，在曲率小的方向上进行拉伸。** 它的作用就是抵消 `H` 带来的不均匀性，将一个椭圆形的世界“变回”圆形。

---

### `-H⁻¹g` 的最终几何意义：指向椭球中心的“牛顿方向”

现在，我们把梯度 `g` 和 `H⁻¹` 结合起来看 `-H⁻¹g`。

1.  **梯度 `-g`**: 这是**最速下降方向**。在我们的等高线椭球上，这个方向**垂直于**当前点的切线。**重要：它并不指向椭球的中心！** （除非椭球是正圆形）

    
    *(负梯度 `-g` 方向垂直于等高线，但没有指向椭球中心。牛顿方向 `-H⁻¹g`直接指向了椭球（二次近似函数的最小值点）的中心。)*

2.  **`H⁻¹` 的作用**:
    *   我们把 `-g` 这个向量输入到 `H⁻¹` 这个变换中。
    *   `H⁻¹` 会对 `-g` 进行一次“地形适应性”的拉伸和旋转。
    *   它会在平缓的方向（椭球长轴方向）上大幅拉长 `-g` 的分量。
    *   它会在陡峭的方向（椭球短轴方向）上大幅压缩 `-g` 的分量。

3.  **最终结果 `-H⁻¹g` (牛顿方向)**:
    *   经过 `H⁻¹` 修正后得到的新方向，**精确地指向了我们二次近似的那个椭球的中心点！**
    *   这个中心点，正是我们二次近似的损失函数的**最小值点**。

**所以，`-H⁻¹g` 的几何意义是：**

它不再是局部最陡峭的下降方向，而是综合了全局（局部二次近似范围内）的曲率信息后，计算出的**直接指向二次近似函数最小值点（椭球中心）的方向向量**。

**一个完美的类比：**

*   **地球**: 是一个椭球体。
*   **重力方向 (梯度 `-g`)**: 在地球表面任何一点，重力方向都**垂直于地平面**（等高面），指向地心方向。但由于地球是椭球，它并不精确地指向地球的质心（几何中心）。
*   **牛顿方向 `-H⁻¹g`**: 相当于一个考虑了地球离心力和不均匀密度的“修正”方向，它能够**精确地指向地球的质心**。

梯度下降是“跟着重力走”，而牛顿法是“直接飞向质心”。